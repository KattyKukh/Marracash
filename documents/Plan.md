## План тестирования сервиса для продажи туристического продукта "Путешествие дня"
### Перечень автоматизируемых сценариев;
#### Покупка тура по карте
Валидные данные по карте:
номер карты 4444 4444 4444 4441 (статус карты: APPROVED),
сочетание значений "Месяц" (от 01 до 12) и "Год" больше или равны текущей даты,
поле Владелец заполнено латиницей, не больше 20 знаков,
поле CVC/CVV заполнено 3 цифрами.
1. Покупка с валидными данными карты. Ожидаемый результат: покупка оформлена, пользователю выведено подтверждение.
2. Покупка с заблокированной картой (4444 4444 4444 4442). Ожидаемый результат: покупка отклонена, пользователю выведено сообщение об ошибке от банковской системы.
3. Покупка с картой с невозможным номером (поле Номер карты заполняется произвольной последовательностью из 20 цифр). Ожидаемый результат: покупка не совершена, пользователю выведено сообщение об ошибке от банковской системы.
4. Покупка с картой с незаполненным номером карты. Ожидаемый результат: покупка отклонена, пользователю выведено сообщение об обязательном заполнении поля.
5. Покупка с картой с истекающим сроком действия (сочетание Месяц и Год равны текущим). Ожидаемый результат: покупка оформлена, пользователю выведено подтверждение.
6. Покупка с картой с истекшим сроком действия (сочетание Месяц и Год ранее текущей даты). Ожидаемый результат: пользователю под полем выведено предупреждение об истекшем сроке действия карты, покупка отклонена.
7. Покупка при указании невозможного значения месяца действия карты (00 или больше 12) Ожидаемый результат: пользователю под полем выведено предупреждение о неверном формате заполнения поля, покупка отклонена.
8. Покупка с картой с незаполненным значением месяца действия карты. Ожидаемый результат: пользователю под полем выведено предупреждение об обязательном заполнении поля, покупка отклонена.
9. Покупка с картой с незаполненным значением года действия карты. Ожидаемый результат: пользователю под полем выведено предупреждение об обязательном заполнении поля, покупка отклонена.
10. Покупка с картой с невалидным именем владельца (указано кириллицей). Ожидаемый результат: пользователю под полем выведено предупреждение о неверном заполнении поля Владелец, покупка отклонена.
11. Покупка с картой с незаполненным именем владельца (поле оставлено пустым). Ожидаемый результат: пользователю под полем выведено предупреждение об обязательном заполнении поля Владелец, покупка отклонена.
12. Покупка без ввода кода подтверждения карты (CVC/CVV не заполнено). Ожидаемый результат: пользователю под полем выведено предупреждение о неверном заполнении поля Владелец, покупка отклонена.
13. Покупка без ввода данных карты. Ожидаемый результат: пользователю под незаполненными полями выведены предупреждения "Поле обязательно для заполнения", покупка отклонена.

#### Покупка тура в кредит (тесты аналогичны покупке за собственные средства).
На данном сайте используются одни и те же поля с одинаковой логикой для заполнения формы покупки за собственные и кредитные средства, но данные отправляются на разные адреса (/pay и /credit), возможно валидацию полей можно проводить только для одного вида покупки, проверяя Happy path для другого).
Валидные данные по карте:
номер карты 4444 4444 4444 4441 (статус карты: APPROVED),
сочетание значений "Месяц" (от 01 до 12) и "Год" больше или равны текущей даты,
поле Владелец заполнено латиницей, не больше 20 знаков,
поле CVC/CVV заполнено 3 цифрами.
1. Покупка с валидными данными карты. Ожидаемый результат: покупка оформлена, пользователю выведено подтверждение, информация внесена в БД в раздел покупок в кредит.
2. Покупка с заблокированной картой (4444 4444 4444 4442). Ожидаемый результат: покупка отклонена, пользователю выведено сообщение об ошибке от банковской системы, информация не внесена в БД.
3. Покупка с картой с невозможным номером (поле Номер карты заполняется произвольной последовательностью из 20 цифр). Ожидаемый результат: покупка не совершена, пользователю выведено сообщение об ошибке от банковской системы.
4. Покупка с картой с незаполненным номером карты. Ожидаемый результат: покупка отклонена, пользователю выведено сообщение об обязательном заполнении поля.
5. Покупка с картой с истекающим сроком действия (сочетание Месяц и Год равны текущим). Ожидаемый результат: покупка оформлена, пользователю выведено подтверждение.
6. Покупка с картой с истекшим сроком действия (сочетание Месяц и Год ранее текущей даты). Ожидаемый результат: пользователю под полем выведено предупреждение об истекшем сроке действия карты, покупка отклонена.
7. Покупка при указании невозможного значения месяца действия карты (00 или больше 12) Ожидаемый результат: пользователю под полем выведено предупреждение о неверном формате заполнения поля, покупка отклонена.
8. Покупка с картой с незаполненным значением месяца действия карты. Ожидаемый результат: пользователю под полем выведено предупреждение об обязательном заполнении поля, покупка отклонена.
9. Покупка с картой с незаполненным значением года действия карты. Ожидаемый результат: пользователю под полем выведено предупреждение об обязательном заполнении поля, покупка отклонена.
10. Покупка с картой с невалидным именем владельца (указано кириллицей). Ожидаемый результат: пользователю под полем выведено предупреждение о неверном заполнении поля Владелец, покупка отклонена.
11. Покупка с картой с незаполненным именем владельца (поле оставлено пустым). Ожидаемый результат: пользователю под полем выведено предупреждение об обязательном заполнении поля Владелец, покупка отклонена.
12. Покупка без ввода кода подтверждения карты (CVC/CVV не заполнено). Ожидаемый результат: пользователю под полем выведено предупреждение о неверном заполнении поля Владелец, покупка отклонена.
13. Покупка без ввода данных карты. Ожидаемый результат: пользователю под незаполненными полями выведены предупреждения "Поле обязательно для заполнения", покупка отклонена.

#### Проверка отображения транзакций в базе данных (БД)
1. Покупка тура за собственные средства с использованием валидных данных карты. Ожидаемый результат: информация внесена в БД в таблицы payment_entity со статусом APPROVED и order_entity, в столбец о покупке за собственные средства.  
2. Покупка тура в кредит с использованием валидных данных карты. Ожидаемый результат: информация внесена в БД в таблицы credit_request_entity со статусом APPROVED и order_entity, в столбец о покупке за кредитные средства. 
3. Покупка тура за собственные средства с использованием данных заблокированной карты. Ожидаемый результат: информация внесена в БД в таблицы payment_entity со статусом DECLINED и order_entity, в столбец о покупке за собственные средства.
4. Покупка тура в кредит с использованием данных заблокированной карты. Ожидаемый результат: информация внесена в БД в таблицы credit_request_entity со статусом DECLINED и order_entity, в столбец о покупке за кредитные средства.

#### Проверка получения сервером данных формы в случае успешной валидации полей
1. Покупка тура за собственные средства с использованием валидных данных карты. Ожидаемый результат: Ответ сервера 200 (Ok).
2. Покупка тура в кредит с использованием данных заблокированной карты. Ожидаемый результат: Ответ сервера 200 (Ok)

### Перечень используемых инструментов с обоснованием выбора;
Тестирование будет автоматизированным, поэтому нужно создать программное обеспечение. Для этого будем использовать:
* Язык программирования Java для создания ПО. Обоснование: распространенный язык программирования, легче поддерживать разработку в дальнейшем.
* IDE IntelliJ IDEA для разработки ПО на языке программирования. Обоснование: часто используемая среда разработки, есть бесплатная версия, поддерживается много framework'ов и библиотек.
* Gradle - система сборки проектов на Java. Обоснование: Эта система сборки позволяет сокращать количество кода при подключении зависимостей, работает со многими библиотеками и framework'ами. 
* Система контроля версий Git для хранения кода тестов. Обоснование: Это позволит реализовать доступ к коду тестов в сети Интернет, вести доработку параллельно с работой тестов (ветвление), а также сохранять предыдущие версии кода. 
Автоматизация тестов производится для web страницы, с поддержкой СУБД для хранения данных, поэтому будем использовать:
* ПО Docker для подключения СУБД MySQL и PostgreSQL, а также работы "заглушки" на Node.js, имитирующей ответ банка.  Обоснование: это позволит воспользоваться виртуальным подключением к СУБД и Node.js, без фактической их установки на конкретную машину исполнителя тестирования.
* Фреймворк Selenide для использования селекторов на страницах, возможности автоматического открытия/закрытия страниц браузера. Обоснование: распространенный инструмент для организации работы с web страницами, открытие и закрытие браузера при тестировании происходит автоматически, обеспечивается совместимость с различными версиями и типами браузеров.
* Паттерн PageObject для описания нужных селекторов для тестируемых элементов для страниц. Обоснование: общепринятый паттерн для организации работы с web страницами.
* Библиотека Apache Commons DbUtils для организации подключения к БД в тестах. Обоснование: удобный инструмент для этой задачи.
* Фреймворк Junit5 для написания тестов. Обоснование: удобное и простое написание тестов, есть удобные аннотации, возможно организовать совместимость с тестами на Junit4.
* Библиотека REST Assured для тестирования получения сервером данных при валидном заполнении формы. Обоснование: нужно проверять, что не происходит сбоя передачи данным между клиентом и сервером при отправке валидных данных о записи на курс. REST Assured удобный инструмент для работы с REST.
* Библиотека Lombok (если возможно) для сокращения объема кода. Обоснование: распространенный инструмент для сокращения объема кода при записи утилитных и data классов.
* Библиотека Faker для имитации невалидных данных при тестировании формы. Обоснование: с помощью Faker можно упростить создание тестовых данных.
* Библиотека Allure позволяет создавать автоматический отчет о прохождении тестов. Обоснование: инструмент имеет наглядное представление результатов, позволяет записать момент падения конкретного теста. Имеет достаточный функционал для создания отчета о тестировании формы.

### Перечень и описание возможных рисков при автоматизации;
1. Недостаточность опыта автоматизации тестирования у исполнителя - риск удлинения сроков написания тестов и настройки тестового окружения (подключения к БД, запуск симулятора обработки платежей).
2. Риски связанные с настройкой тестового окружения: запуск контейнеров для подключения к СУБД, запуск "заглушки" для имитации ответов банковской системы.
3. Отсутствие уникальных привязок для элементов страницы - риск необходимости корректировки селекторов при изменении структуры страницы или сайта.
4. Вместо реального подключения к системам оплаты используется "заглушка" - риск неверной оценки реакции банковской системы. При тестировании не будет учтено время подтверждения оплаты, одобрения кредитной операции, а также совпадение требований по валидации данных карты реальной банковской системой (в частности номера карты и имени владельца).
5. Тестирование выполняется 1 исполнителем - риски связанные с состоянием здоровья и инфраструктурой исполнителя. Возможность заболеть (сезон ОРВИ), возможность проблем с подключением к сети интернет.

### Интервальная оценка с учётом рисков в часах;
* Планирование автоматизации тестирования - 16 рабочих часов.
* Проведение автоматизации тестов, настройка тестового окружения - 40 рабочих часов.
* Подготовка отчётных документов по итогам автоматизированного тестирования - 16 рабочих часов.
* Подготовка отчётных документов по итогам автоматизации - 8 рабочих часов.
* Запас на непредвиденные обстоятельства (болезнь, отсутствие интернет доступа) - 24 рабочих часа.

### План сдачи работ: когда будут готовы автотесты, результаты их прогона;
* Готовность кода автотестов - 19.12.2022
* Готовность отчетных документов по итогам тестирования - 22.12.2022
* Готовность отчетных документов по итогам автоматизации - 24.12.2022